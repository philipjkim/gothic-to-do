# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project

GoTHIC stack (Go+Gin, Templ, HTMX, Alpine.js, TailwindCSS+DaisyUI) To-Do web app. Server-side rendered with minimal JavaScript.

## Commands

```bash
make dev          # Start dev server (air hot-reload + tailwind --watch, parallel)
make build        # Production build (templ generate + css minify + go build → ./bin/server)
make templ        # Run templ generate only
make css          # Run TailwindCSS build only (minified)
templ generate    # Generate Go code from .templ files (required before go build)
air               # Hot-reload server (reads .air.toml)
go build ./...    # Verify all packages compile
```

## Architecture

```
cmd/server/main.go → Gin router, routes, static file serving
internal/handler/  → HTTP handlers, render() helper using templ.Component
internal/model/    → Todo domain struct
internal/store/    → In-memory store with sync.RWMutex
templates/         → Templ components (flat package, no subdirectories)
static/css/        → TailwindCSS v4 input/output
```

**Request flow**: Gin route → handler → store (thread-safe) → templ component → HTML response. All mutation handlers respond with the full `TodoList` HTML partial; HTMX swaps `#todo-list` innerHTML.

**HTMX vs Alpine.js split**: HTMX handles server communication (CRUD). Alpine.js handles client-only UI state (theme toggle, inline edit mode toggle). Some components use both (inline editing: Alpine.js toggles UI, HTMX saves to server).

## Key Constraints

- **Templ flat package**: All `.templ` files must be in `templates/` directly. Subdirectories require a separate package name, which breaks the current architecture.
- **TailwindCSS v4**: Uses CSS-first config (`@import "tailwindcss"` + `@plugin "daisyui"` in `input.css`), NOT the legacy `tailwind.config.js` approach.
- **Generated files**: `*_templ.go` files are gitignored and generated by `templ generate`. The `.air.toml` excludes `_templ.go` from watch to prevent infinite reload loops.
- **In-memory store**: Data is lost on restart. Intentional for this demo.
- **Tool versions**: Go managed by asdf (`.tool-versions`), Node/npm managed by Volta (`package.json` volta section).

## Conventions

- **Language**: All code, comments, and commit messages in English. `README_kr.md` exists as Korean translation.
- **Commits**: Conventional Commits format (`feat:`, `fix:`, `chore:`, `docs:`, etc.). No `Co-Authored-By` lines. Use `/commit-en` skill.
- **Work notes**: Session documentation goes in `docs/works/` in Korean.
